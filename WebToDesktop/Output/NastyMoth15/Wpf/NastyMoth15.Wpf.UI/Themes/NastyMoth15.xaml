<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="clr-namespace:NastyMoth15.Wpf.UI.Controls">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/NastyMoth15.Wpf.UI;component/Themes/NastyMoth15Resources.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <Style TargetType="{x:Type controls:NastyMoth15}">
        <Setter Property="Width" Value="134" />
        <Setter Property="Height" Value="74" />
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:NastyMoth15}">
                    <Grid>
                        <!-- Outer layer (toggle-label::before) - Gray background with border -->
                        <Border x:Name="OuterBorder"
                                CornerRadius="37"
                                Background="{StaticResource NastyMoth15.Brush.Gray}"
                                BorderBrush="{StaticResource NastyMoth15.Brush.Border.Normal}"
                                BorderThickness="1,1,1,0" />

                        <!-- Inner layer (toggle-label::after) - RadialGradient glow -->
                        <Border x:Name="GlowBorder"
                                Margin="12"
                                CornerRadius="25">
                            <Border.Background>
                                <RadialGradientBrush GradientOrigin="0.5,0" Center="0.5,0" RadiusX="0.5" RadiusY="1">
                                    <GradientStop Color="#3A9BFC" Offset="0" />
                                    <GradientStop Color="#0C0C0C" Offset="0.8" />
                                </RadialGradientBrush>
                            </Border.Background>
                        </Border>

                        <!-- Main toggle label background -->
                        <Border x:Name="LabelBorder"
                                Margin="12"
                                CornerRadius="25"
                                Background="{StaticResource NastyMoth15.Brush.Dark}"
                                BorderBrush="{StaticResource NastyMoth15.Brush.Border.Normal}"
                                BorderThickness="1,1,1,0"
                                Padding="8">

                            <!-- Toggle knob container -->
                            <Border x:Name="KnobContainer"
                                    Width="50"
                                    Height="50"
                                    CornerRadius="25"
                                    BorderBrush="{StaticResource NastyMoth15.Brush.Border.Icon}"
                                    BorderThickness="1,1,1,0"
                                    HorizontalAlignment="Left"
                                    RenderTransformOrigin="0.5,0.5"
                                    ClipToBounds="True">
                                <Border.Background>
                                    <RadialGradientBrush GradientOrigin="0.5,0" Center="0.5,0" RadiusX="0.5" RadiusY="1">
                                        <GradientStop Color="#666666" Offset="0" />
                                        <GradientStop Color="{StaticResource NastyMoth15.Color.Gray}" Offset="1" />
                                    </RadialGradientBrush>
                                </Border.Background>
                                <Border.RenderTransform>
                                    <TransformGroup>
                                        <TranslateTransform x:Name="KnobTranslate" X="0" />
                                        <RotateTransform x:Name="KnobRotate" Angle="0" />
                                    </TransformGroup>
                                </Border.RenderTransform>

                                <Grid>
                                    <!-- Sparkle container with clipping -->
                                    <Canvas x:Name="SparkleCanvas"
                                            Width="50"
                                            Height="50"
                                            ClipToBounds="True">
                                        <!-- Sparkle elements - positioned at center, rotating outward -->
                                        <!-- Each ellipse represents a sparkle with different angle and animation duration -->

                                        <!-- Sparkle 1: deg=25, duration=11 -->
                                        <Ellipse x:Name="Sparkle1" Width="2" Height="2"
                                                 Fill="{StaticResource NastyMoth15.Brush.Light}"
                                                 Canvas.Left="24" Canvas.Top="24"
                                                 RenderTransformOrigin="0.5,0.5">
                                            <Ellipse.RenderTransform>
                                                <TransformGroup>
                                                    <RotateTransform Angle="25" />
                                                    <TranslateTransform x:Name="SparkleTranslate1" X="0" />
                                                </TransformGroup>
                                            </Ellipse.RenderTransform>
                                        </Ellipse>

                                        <!-- Sparkle 2: deg=100, duration=18 -->
                                        <Ellipse x:Name="Sparkle2" Width="1" Height="1"
                                                 Fill="{StaticResource NastyMoth15.Brush.Light}"
                                                 Canvas.Left="24.5" Canvas.Top="24.5"
                                                 RenderTransformOrigin="0.5,0.5">
                                            <Ellipse.RenderTransform>
                                                <TransformGroup>
                                                    <RotateTransform Angle="100" />
                                                    <TranslateTransform x:Name="SparkleTranslate2" X="0" />
                                                </TransformGroup>
                                            </Ellipse.RenderTransform>
                                        </Ellipse>

                                        <!-- Sparkle 3: deg=280, duration=5 -->
                                        <Ellipse x:Name="Sparkle3" Width="1" Height="1"
                                                 Fill="{StaticResource NastyMoth15.Brush.Light}"
                                                 Canvas.Left="24.5" Canvas.Top="24.5"
                                                 RenderTransformOrigin="0.5,0.5">
                                            <Ellipse.RenderTransform>
                                                <TransformGroup>
                                                    <RotateTransform Angle="280" />
                                                    <TranslateTransform x:Name="SparkleTranslate3" X="0" />
                                                </TransformGroup>
                                            </Ellipse.RenderTransform>
                                        </Ellipse>

                                        <!-- Sparkle 4: deg=200, duration=3 -->
                                        <Ellipse x:Name="Sparkle4" Width="2" Height="2"
                                                 Fill="{StaticResource NastyMoth15.Brush.Light}"
                                                 Canvas.Left="24" Canvas.Top="24"
                                                 RenderTransformOrigin="0.5,0.5">
                                            <Ellipse.RenderTransform>
                                                <TransformGroup>
                                                    <RotateTransform Angle="200" />
                                                    <TranslateTransform x:Name="SparkleTranslate4" X="0" />
                                                </TransformGroup>
                                            </Ellipse.RenderTransform>
                                        </Ellipse>

                                        <!-- Sparkle 5: deg=30, duration=20 -->
                                        <Ellipse x:Name="Sparkle5" Width="2" Height="2"
                                                 Fill="{StaticResource NastyMoth15.Brush.Light}"
                                                 Canvas.Left="24" Canvas.Top="24"
                                                 RenderTransformOrigin="0.5,0.5">
                                            <Ellipse.RenderTransform>
                                                <TransformGroup>
                                                    <RotateTransform Angle="30" />
                                                    <TranslateTransform x:Name="SparkleTranslate5" X="0" />
                                                </TransformGroup>
                                            </Ellipse.RenderTransform>
                                        </Ellipse>

                                        <!-- Sparkle 6: deg=300, duration=9 -->
                                        <Ellipse x:Name="Sparkle6" Width="2" Height="2"
                                                 Fill="{StaticResource NastyMoth15.Brush.Light}"
                                                 Canvas.Left="24" Canvas.Top="24"
                                                 RenderTransformOrigin="0.5,0.5">
                                            <Ellipse.RenderTransform>
                                                <TransformGroup>
                                                    <RotateTransform Angle="300" />
                                                    <TranslateTransform x:Name="SparkleTranslate6" X="0" />
                                                </TransformGroup>
                                            </Ellipse.RenderTransform>
                                        </Ellipse>

                                        <!-- Sparkle 7: deg=250, duration=4 -->
                                        <Ellipse x:Name="Sparkle7" Width="1" Height="1"
                                                 Fill="{StaticResource NastyMoth15.Brush.Light}"
                                                 Canvas.Left="24.5" Canvas.Top="24.5"
                                                 RenderTransformOrigin="0.5,0.5">
                                            <Ellipse.RenderTransform>
                                                <TransformGroup>
                                                    <RotateTransform Angle="250" />
                                                    <TranslateTransform x:Name="SparkleTranslate7" X="0" />
                                                </TransformGroup>
                                            </Ellipse.RenderTransform>
                                        </Ellipse>

                                        <!-- Sparkle 8: deg=210, duration=8 -->
                                        <Ellipse x:Name="Sparkle8" Width="2" Height="2"
                                                 Fill="{StaticResource NastyMoth15.Brush.Light}"
                                                 Canvas.Left="24" Canvas.Top="24"
                                                 RenderTransformOrigin="0.5,0.5">
                                            <Ellipse.RenderTransform>
                                                <TransformGroup>
                                                    <RotateTransform Angle="210" />
                                                    <TranslateTransform x:Name="SparkleTranslate8" X="0" />
                                                </TransformGroup>
                                            </Ellipse.RenderTransform>
                                        </Ellipse>
                                    </Canvas>

                                    <!-- Flag icon in center -->
                                    <Path x:Name="FlagIcon"
                                          Data="{StaticResource NastyMoth15.Icon.Flag}"
                                          Fill="{StaticResource NastyMoth15.Brush.Light}"
                                          Width="17.6"
                                          Height="17.6"
                                          Stretch="Uniform"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center" />
                                </Grid>
                            </Border>
                        </Border>
                    </Grid>

                    <ControlTemplate.Triggers>
                        <!-- Checked state -->
                        <Trigger Property="IsChecked" Value="True">
                            <!-- Label border becomes transparent with teal border -->
                            <Setter TargetName="LabelBorder" Property="Background" Value="Transparent" />
                            <Setter TargetName="LabelBorder" Property="BorderBrush" Value="{StaticResource NastyMoth15.Brush.Border.Checked}" />

                            <!-- Knob moves right and rotates -->
                            <Setter TargetName="KnobContainer" Property="BorderBrush" Value="{StaticResource NastyMoth15.Brush.Primary}" />
                            <Setter TargetName="KnobContainer" Property="Background">
                                <Setter.Value>
                                    <RadialGradientBrush GradientOrigin="0.5,0" Center="0.5,0" RadiusX="0.5" RadiusY="1">
                                        <GradientStop Color="{StaticResource NastyMoth15.Color.Checked.GradientStart}" Offset="0" />
                                        <GradientStop Color="{StaticResource NastyMoth15.Color.Primary}" Offset="1" />
                                    </RadialGradientBrush>
                                </Setter.Value>
                            </Setter>
                            <Setter TargetName="KnobContainer" Property="ClipToBounds" Value="False" />
                        </Trigger>

                        <!-- Animation triggers -->
                        <EventTrigger RoutedEvent="Loaded">
                            <BeginStoryboard>
                                <Storyboard RepeatBehavior="Forever">
                                    <!-- Sparkle animations - moving outward -->
                                    <DoubleAnimation Storyboard.TargetName="SparkleTranslate1"
                                                     Storyboard.TargetProperty="X"
                                                     From="0" To="50"
                                                     Duration="0:0:9.09" />
                                    <DoubleAnimation Storyboard.TargetName="SparkleTranslate2"
                                                     Storyboard.TargetProperty="X"
                                                     From="0" To="50"
                                                     Duration="0:0:5.55" />
                                    <DoubleAnimation Storyboard.TargetName="SparkleTranslate3"
                                                     Storyboard.TargetProperty="X"
                                                     From="0" To="50"
                                                     Duration="0:0:20" />
                                    <DoubleAnimation Storyboard.TargetName="SparkleTranslate4"
                                                     Storyboard.TargetProperty="X"
                                                     From="0" To="50"
                                                     Duration="0:0:33.33" />
                                    <DoubleAnimation Storyboard.TargetName="SparkleTranslate5"
                                                     Storyboard.TargetProperty="X"
                                                     From="0" To="50"
                                                     Duration="0:0:5" />
                                    <DoubleAnimation Storyboard.TargetName="SparkleTranslate6"
                                                     Storyboard.TargetProperty="X"
                                                     From="0" To="50"
                                                     Duration="0:0:11.11" />
                                    <DoubleAnimation Storyboard.TargetName="SparkleTranslate7"
                                                     Storyboard.TargetProperty="X"
                                                     From="0" To="50"
                                                     Duration="0:0:25" />
                                    <DoubleAnimation Storyboard.TargetName="SparkleTranslate8"
                                                     Storyboard.TargetProperty="X"
                                                     From="0" To="50"
                                                     Duration="0:0:12.5" />
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>

                        <!-- Checked animation -->
                        <Trigger Property="IsChecked" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="KnobTranslate"
                                                         Storyboard.TargetProperty="X"
                                                         To="60"
                                                         Duration="0:0:0.3">
                                            <DoubleAnimation.EasingFunction>
                                                <CubicEase EasingMode="EaseInOut" />
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                        <DoubleAnimation Storyboard.TargetName="KnobRotate"
                                                         Storyboard.TargetProperty="Angle"
                                                         To="-225"
                                                         Duration="0:0:0.3">
                                            <DoubleAnimation.EasingFunction>
                                                <CubicEase EasingMode="EaseInOut" />
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="KnobTranslate"
                                                         Storyboard.TargetProperty="X"
                                                         To="0"
                                                         Duration="0:0:0.3">
                                            <DoubleAnimation.EasingFunction>
                                                <CubicEase EasingMode="EaseInOut" />
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                        <DoubleAnimation Storyboard.TargetName="KnobRotate"
                                                         Storyboard.TargetProperty="Angle"
                                                         To="0"
                                                         Duration="0:0:0.3">
                                            <DoubleAnimation.EasingFunction>
                                                <CubicEase EasingMode="EaseInOut" />
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>
