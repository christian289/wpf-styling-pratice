<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="clr-namespace:BlackRabbit68.Wpf.UI.Controls">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/BlackRabbit68.Wpf.UI;component/Themes/BlackRabbit68Resources.xaml"/>
    </ResourceDictionary.MergedDictionaries>

    <Style TargetType="{x:Type controls:BlackRabbit68}">
        <Setter Property="Width" Value="200"/>
        <Setter Property="Height" Value="200"/>
        <Setter Property="CoinSize" Value="200"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:BlackRabbit68}">
                    <Viewbox Stretch="Uniform">
                        <Grid Width="{TemplateBinding CoinSize}" Height="{TemplateBinding CoinSize}">
                            <!-- Coin Container with 3D rotation simulation -->
                            <Grid x:Name="CoinContainer" RenderTransformOrigin="0.5,0.5">
                                <Grid.RenderTransform>
                                    <TransformGroup>
                                        <ScaleTransform x:Name="CoinScaleX" ScaleX="1" ScaleY="1"/>
                                    </TransformGroup>
                                </Grid.RenderTransform>

                                <!-- Coin Edge (visible when coin is sideways) -->
                                <Rectangle x:Name="CoinEdge"
                                           Width="20"
                                           Height="{TemplateBinding CoinSize}"
                                           Fill="{StaticResource BlackRabbit68.CoinEdge.Brush}"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Visibility="Collapsed"/>

                                <!-- Heads Side (Front) -->
                                <Grid x:Name="HeadsSide">
                                    <Ellipse Fill="{StaticResource BlackRabbit68.Bitcoin.OrangeBrush}"/>
                                    <Viewbox Margin="10">
                                        <Canvas Width="4091.27" Height="4091.73">
                                            <Path Fill="{StaticResource BlackRabbit68.Bitcoin.OrangeBrush}"
                                                  Data="{StaticResource BlackRabbit68.Bitcoin.CirclePath}"/>
                                            <Path Fill="{StaticResource BlackRabbit68.Bitcoin.WhiteBrush}"
                                                  Data="{StaticResource BlackRabbit68.Bitcoin.SymbolPath}"/>
                                        </Canvas>
                                    </Viewbox>
                                </Grid>

                                <!-- Tails Side (Back - mirrored) -->
                                <Grid x:Name="TailsSide" Visibility="Collapsed" RenderTransformOrigin="0.5,0.5">
                                    <Grid.RenderTransform>
                                        <ScaleTransform ScaleX="-1"/>
                                    </Grid.RenderTransform>
                                    <Ellipse Fill="{StaticResource BlackRabbit68.Bitcoin.OrangeBrush}"/>
                                    <Viewbox Margin="10">
                                        <Canvas Width="4091.27" Height="4091.73">
                                            <Path Fill="{StaticResource BlackRabbit68.Bitcoin.OrangeBrush}"
                                                  Data="{StaticResource BlackRabbit68.Bitcoin.CirclePath}"/>
                                            <Path Fill="{StaticResource BlackRabbit68.Bitcoin.WhiteBrush}"
                                                  Data="{StaticResource BlackRabbit68.Bitcoin.SymbolPath}"/>
                                        </Canvas>
                                    </Viewbox>
                                </Grid>
                            </Grid>
                        </Grid>
                    </Viewbox>

                    <ControlTemplate.Triggers>
                        <EventTrigger RoutedEvent="Loaded">
                            <BeginStoryboard>
                                <Storyboard RepeatBehavior="Forever">
                                    <!--
                                    3D 회전을 2D ScaleX로 시뮬레이션
                                    ScaleX: 1 -> 0 -> -1 -> 0 -> 1 사이클
                                    -->

                                    <!-- Phase 1: Front face shrinking (0-25%) -->
                                    <DoubleAnimationUsingKeyFrames
                                        Storyboard.TargetName="CoinScaleX"
                                        Storyboard.TargetProperty="ScaleX">
                                        <LinearDoubleKeyFrame KeyTime="0:0:0" Value="1"/>
                                        <LinearDoubleKeyFrame KeyTime="0:0:1.75" Value="0"/>
                                        <LinearDoubleKeyFrame KeyTime="0:0:3.5" Value="-1"/>
                                        <LinearDoubleKeyFrame KeyTime="0:0:5.25" Value="0"/>
                                        <LinearDoubleKeyFrame KeyTime="0:0:7" Value="1"/>
                                    </DoubleAnimationUsingKeyFrames>

                                    <!-- Show/Hide Heads based on rotation phase -->
                                    <ObjectAnimationUsingKeyFrames
                                        Storyboard.TargetName="HeadsSide"
                                        Storyboard.TargetProperty="Visibility">
                                        <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="{x:Static Visibility.Visible}"/>
                                        <DiscreteObjectKeyFrame KeyTime="0:0:1.75" Value="{x:Static Visibility.Collapsed}"/>
                                        <DiscreteObjectKeyFrame KeyTime="0:0:5.25" Value="{x:Static Visibility.Visible}"/>
                                    </ObjectAnimationUsingKeyFrames>

                                    <!-- Show/Hide Tails based on rotation phase -->
                                    <ObjectAnimationUsingKeyFrames
                                        Storyboard.TargetName="TailsSide"
                                        Storyboard.TargetProperty="Visibility">
                                        <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="{x:Static Visibility.Collapsed}"/>
                                        <DiscreteObjectKeyFrame KeyTime="0:0:1.75" Value="{x:Static Visibility.Visible}"/>
                                        <DiscreteObjectKeyFrame KeyTime="0:0:5.25" Value="{x:Static Visibility.Collapsed}"/>
                                    </ObjectAnimationUsingKeyFrames>

                                    <!-- Show edge when coin is sideways -->
                                    <ObjectAnimationUsingKeyFrames
                                        Storyboard.TargetName="CoinEdge"
                                        Storyboard.TargetProperty="Visibility">
                                        <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="{x:Static Visibility.Collapsed}"/>
                                        <DiscreteObjectKeyFrame KeyTime="0:0:1.6" Value="{x:Static Visibility.Visible}"/>
                                        <DiscreteObjectKeyFrame KeyTime="0:0:1.9" Value="{x:Static Visibility.Collapsed}"/>
                                        <DiscreteObjectKeyFrame KeyTime="0:0:5.1" Value="{x:Static Visibility.Visible}"/>
                                        <DiscreteObjectKeyFrame KeyTime="0:0:5.4" Value="{x:Static Visibility.Collapsed}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>
