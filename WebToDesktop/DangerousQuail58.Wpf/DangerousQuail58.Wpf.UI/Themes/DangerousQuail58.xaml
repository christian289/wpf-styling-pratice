<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="clr-namespace:DangerousQuail58.Wpf.UI.Controls">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/DangerousQuail58.Wpf.UI;component/Themes/DangerousQuail58Resources.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <Style TargetType="{x:Type controls:DangerousQuail58}">
        <Setter Property="Width" Value="{StaticResource DangerousQuail58.Width}" />
        <Setter Property="Height" Value="{StaticResource DangerousQuail58.Height}" />
        <Setter Property="Foreground" Value="{StaticResource DangerousQuail58.Foreground}" />
        <Setter Property="FontSize" Value="{StaticResource DangerousQuail58.FontSize}" />
        <Setter Property="FontWeight" Value="Bold" />
        <Setter Property="HorizontalContentAlignment" Value="Center" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:DangerousQuail58}">
                    <!--  둥근 모서리 클리핑을 위한 외부 Border  -->
                    <!--  Outer Border for rounded corner clipping  -->
                    <Border x:Name="OuterBorder"
                            Background="{StaticResource DangerousQuail58.Background}"
                            CornerRadius="{StaticResource DangerousQuail58.CornerRadius}">
                        <Border.Clip>
                            <RectangleGeometry RadiusX="{StaticResource DangerousQuail58.CornerRadius.Value}"
                                               RadiusY="{StaticResource DangerousQuail58.CornerRadius.Value}">
                                <RectangleGeometry.Rect>
                                    <MultiBinding Converter="{x:Static controls:DangerousQuail58.RectConverter}">
                                        <Binding Path="ActualWidth" RelativeSource="{RelativeSource AncestorType=Border}" />
                                        <Binding Path="ActualHeight" RelativeSource="{RelativeSource AncestorType=Border}" />
                                    </MultiBinding>
                                </RectangleGeometry.Rect>
                            </RectangleGeometry>
                        </Border.Clip>

                        <Grid>
                            <!--  회전 요소를 담는 Canvas (크기 제한 없음)  -->
                            <!--  Canvas for rotating element (no size constraint)  -->
                            <Canvas>
                                <!--  2. 회전하는 그라데이션 바 (.card::before)  -->
                                <!--  2. Rotating gradient bar (.card::before)  -->
                                <Rectangle x:Name="GradientBar"
                                           Width="{StaticResource DangerousQuail58.GradientBar.Width}"
                                           Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType=Border}, Converter={x:Static controls:DangerousQuail58.HeightMultiplierConverter}, ConverterParameter={StaticResource DangerousQuail58.GradientBar.HeightMultiplier}}"
                                           Fill="{StaticResource DangerousQuail58.GradientBar.Fill}"
                                           Canvas.Left="{StaticResource DangerousQuail58.GradientBar.Left}"
                                           Canvas.Top="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType=Border}, Converter={x:Static controls:DangerousQuail58.CenterOffsetConverter}, ConverterParameter={StaticResource DangerousQuail58.GradientBar.HeightMultiplier}}"
                                           RenderTransformOrigin="0.5,0.5">
                                    <Rectangle.RenderTransform>
                                        <RotateTransform x:Name="GradientBarRotation" Angle="0" />
                                    </Rectangle.RenderTransform>
                                </Rectangle>

                                <!--  3. 내부 배경 (.card::after) - 테두리 효과 생성  -->
                                <!--  3. Inner background (.card::after) - creates border effect  -->
                                <Border Canvas.Left="{StaticResource DangerousQuail58.Inner.Margin.Value}"
                                        Canvas.Top="{StaticResource DangerousQuail58.Inner.Margin.Value}"
                                        Width="{StaticResource DangerousQuail58.Inner.Width}"
                                        Height="{StaticResource DangerousQuail58.Inner.Height}"
                                        Background="{StaticResource DangerousQuail58.Background}"
                                        CornerRadius="{StaticResource DangerousQuail58.Inner.CornerRadius}" />
                            </Canvas>

                            <!--  4. 콘텐츠 (.card h2) - Grid 내에서 중앙 정렬  -->
                            <!--  4. Content (.card h2) - centered in Grid  -->
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              Margin="{TemplateBinding Padding}" />
                        </Grid>
                    </Border>

                    <ControlTemplate.Triggers>
                        <EventTrigger RoutedEvent="Loaded">
                            <BeginStoryboard>
                                <Storyboard RepeatBehavior="Forever">
                                    <DoubleAnimation Storyboard.TargetName="GradientBarRotation"
                                                     Storyboard.TargetProperty="Angle"
                                                     From="0"
                                                     To="360"
                                                     Duration="0:0:3" />
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>
